local DrawSprite=DrawSprite;local DrawRect=DrawRect;local a=false;local b=false;local c;local d=1;local e=0;local f={}local g=0;local h={}local i=0;local j={0,0,0}local k={}local l={}local m=6;local n=nil;local o={{250,172,54},{247,49,49},{58,53,212}}local p={{191,191,191},{88,204,102}}local q=255;local r={255,255,255}local s={'Icons__x1','Icons__x2','Icons__x3','Icons__x5','Icons__x10','Icons__x15'}local t={1,10,50}local u={{0.383,0.815,0.0145,0.05},{0.373,0.815,0.0145,0.05},{0.363,0.815,0.0145,0.05},{0.353,0.815,0.0145,0.05},{0.343,0.815,0.0145,0.05},{0.333,0.815,0.0145,0.05}}local v={['1']={['1']={['square1']={0.324,0.307,0.006,0.01},['square2']={0.658,0.307,0.006,0.01},['line']={0.49,0.307,0.33,0.004}},['2']={['square1']={0.324,0.307,0.006,0.01},['sqaure2']={0.49,0.307,0.007,0.0135},['square3']={0.49,0.501,0.007,0.0128},['square4']={0.657,0.501,0.007,0.0128},['line1']={0.407,0.307,0.16,0.004},['line2']={0.4905,0.404,0.002,0.18},['line3']={0.574,0.501,0.16,0.004}},['3']={['square1']={0.324,0.307,0.007,0.0128,250,172,54,255},['square2']={0.397,0.307,0.007,0.0128,250,172,54,255},['square3']={0.397,0.502,0.007,0.0128,250,172,54,255},['square4']={0.49,0.502,0.007,0.0128,250,172,54,255},['square5']={0.49,0.694,0.007,0.0128,250,172,54,255},['square6']={0.657,0.694,0.007,0.0128,250,172,54,255},['line1']={0.36,0.307,0.07,0.004,250,172,54,255},['line2']={0.3965,0.404,0.002,0.182,250,172,54,255},['line3']={0.445,0.502,0.09,0.004,250,172,54,255},['line4']={0.4905,0.598,0.002,0.182,250,172,54,255},['line5']={0.574,0.694,0.16,0.004,250,172,54,255}}},['2']={['1']={['square1']={0.324,0.5,0.006,0.01},['square2']={0.46,0.5,0.007,0.01281},['square3']={0.46,0.39,0.007,0.01281},['square4']={0.551,0.39,0.007,0.01281},['square5']={0.551,0.307,0.007,0.01281},['square6']={0.658,0.307,0.006,0.01},['line1']={0.392,0.5,0.129,0.0035},['line2']={0.46,0.444,0.003,0.1},['line3']={0.508,0.39,0.09,0.004},['line4']={0.508,0.39,0.09,0.0025},['line5']={0.605,0.307,0.108,0.004},['line6']={0.551,0.35,0.0025,0.08}},['2']={['square1']={0.324,0.5,0.006,0.01},['square2']={0.657,0.5,0.006,0.01},['line1']={0.49,0.5,0.33,0.004}},['3']={['square1']={0.324,0.5,0.006,0.01},['square2']={0.429,0.5,0.007,0.01281},['square3']={0.429,0.694,0.007,0.01281},['square4']={0.657,0.694,0.007,0.01281},['line1']={0.376,0.5,0.1,0.0035},['line2']={0.429,0.6,0.003,0.2},['line3']={0.543,0.694,0.22,0.0035}}},['3']={['1']={['square1']={0.324,0.694,0.006,0.01},['square2']={0.521,0.694,0.007,0.01281},['square3']={0.521,0.61,0.007,0.01281},['square4']={0.582,0.61,0.007,0.01281},['square5']={0.582,0.3085,0.007,0.01281},['square6']={0.6565,0.307,0.007,0.01281},['line1']={0.421,0.694,0.19,0.0035},['line2']={0.521,0.652,0.00222,0.074},['line3']={0.55,0.61,0.06,0.0035},['line4']={0.582,0.46,0.00222,0.29},['line5']={0.62,0.307,0.07,0.0035}},['2']={['sqaure1']={0.324,0.694,0.006,0.01},['sqaure2']={0.521,0.694,0.007,0.01281},['sqaure3']={0.521,0.61,0.007,0.01281},['sqaure4']={0.582,0.61,0.007,0.01281},['sqaure5']={0.582,0.5,0.007,0.01281},['sqaure6']={0.6565,0.5,0.007,0.01281},['line1']={0.421,0.694,0.19,0.0035},['line2']={0.521,0.652,0.00222,0.074},['line3']={0.55,0.61,0.06,0.0035},['line4']={0.582,0.55,0.00222,0.11},['line5']={0.62,0.5,0.07,0.0035}},['3']={['square1']={0.324,0.694,0.006,0.01},['square2']={0.6565,0.694,0.007,0.01281},['line1']={0.49,0.694,0.33,0.0035}}}}local function w(x)local y={}for z=1,#x do y[z]=x[z]end;for z=#y,2,-1 do local A=math.random(z)y[z],y[A]=y[A],y[z]end;return y end;local function B(x)local C=0;for D,E in pairs(x)do C=C+1 end;return C end;local function F(G,H)PlaySoundFrontend(-1,G,H,true)end;local function I()g=0;for z=1,3 do f[z]=math.random(1,8)end;for z=1,3 do g=g+f[z]*t[z]end end;local function J(K)K=K or i;local i=tostring(K)if string.len(i)<3 then for z=1,3-string.len(i)do i='0'..i end end;for z=1,3 do j[z]=i:sub(z,z)end end;local function L()local M=tostring(g)if string.len(M)<3 then for z=1,3-string.len(M)do M='0'..M end end;for z=1,3 do h[z]=M:sub(z,z)end end;local function N(O,P,Q,R,S,T,U,V)DrawRect(O,P,Q,R,S,T,U,V)end;local function W(X,Y,Z,_,a0,a1,a2,a3,a4,a5,a6)DrawSprite(X,Y,Z,_,a0,a1,a2,a3,a4,a5,a6)end;function ButtonMessage(a7)BeginTextCommandScaleformString("STRING")AddTextComponentSubstringKeyboardDisplay(a7)EndTextCommandScaleformString()end;function Button(a8)ScaleformMovieMethodAddParamPlayerNameString(a8)end;function setupScaleform(a9)local a9=RequestScaleformMovie(a9)while not HasScaleformMovieLoaded(a9)do Citizen.Wait(0)end;BeginScaleformMovieMethod(a9,"CLEAR_ALL")EndScaleformMovieMethod()BeginScaleformMovieMethod(a9,"SET_CLEAR_SPACE")ScaleformMovieMethodAddParamInt(200)EndScaleformMovieMethod()BeginScaleformMovieMethod(a9,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(0)Button(GetControlInstructionalButton(2,194,true))ButtonMessage("Abort Hack")EndScaleformMovieMethod()BeginScaleformMovieMethod(a9,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(1)Button(GetControlInstructionalButton(2,191,true))ButtonMessage("Confirm selection (Irrevertible)")EndScaleformMovieMethod()BeginScaleformMovieMethod(a9,"SET_DATA_SLOT")ScaleformMovieMethodAddParamInt(2)Button(GetControlInstructionalButton(2,307,true))Button(GetControlInstructionalButton(2,308,true))Button(GetControlInstructionalButton(2,299,true))Button(GetControlInstructionalButton(2,300,true))ButtonMessage("Select")EndScaleformMovieMethod()BeginScaleformMovieMethod(a9,"DRAW_INSTRUCTIONAL_BUTTONS")EndScaleformMovieMethod()BeginScaleformMovieMethod(a9,"SET_BACKGROUND_COLOUR")ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(0)ScaleformMovieMethodAddParamInt(80)EndScaleformMovieMethod()return a9 end;local aa={'MPIsland_Voltage','MPIsland_Voltage_BG'}local ab='DLC_HEI4\\DLC_HEI4_V_MG'local ac='DLC_HEI4\\DLC_HEI4_FH_MG'local function ad()for z=1,#aa do RequestStreamedTextureDict(aa[z],false)end;for z=1,#aa do while not HasStreamedTextureDictLoaded(aa[z])do Wait(10)end end;local ae=GetGameTimer()while not RequestScriptAudioBank(ab,false)do if GetGameTimer()-ae>1500 then ReleaseNamedScriptAudioBank(ab)break end;Citizen.Wait(0)end;local af=GetGameTimer()while not RequestScriptAudioBank(ac,false)do if GetGameTimer()-af>1500 then ReleaseNamedScriptAudioBank(ac)break end;Citizen.Wait(0)end end;local function ag()ReleaseNamedScriptAudioBank(ac)ReleaseNamedScriptAudioBank(ab)for z=1,#aa do SetStreamedTextureDictAsNoLongerNeeded(aa[z])end end;AddEventHandler("ultra-voltlab",function(ah,ai)ad()b=false;k={}l={}d=1;e=0;m=6;c=function(...)ag()ai(...)end;local ah=tonumber(ah)timer=ah;if ah<10 or ah>60 then c(-1,'Entered time is out of range')b=true;return end;I()L()while g>999 or g<=0 do Wait(10)I()end;f=w(f)t=w(t)s=w(s)local aj=0;for z=1,3 do aj=aj+t[z]end;if aj>111 or aj<=0 then c(-1,'Icon values are out of range in config')b=true;return end;L()a=true;print("Creating first Voltlab hacking thread")CreateThread(function()Wait(100)SendNUIMessage({type='intro'})F('Loading_Bink','DLC_H4_Voltage_Minigame_Sounds')while a do Wait(1)W('MPIsland_Voltage_BG','PHONE_BACKGROUND',0.50,0.50,1.0,1.0,0,255,255,255,255)W('MPIsland_Voltage_BG','target_text',0.498,0.12,0.04,0.014,0,231,99,99,255)W('MPIsland_Voltage_BG','result_text',0.498,0.88,0.04,0.014,0,88,204,102,255)W('MPIsland_Voltage','Phone_Icons',0.95,0.03,0.08,0.04,0,160,160,160,255)W('MPIsland_Voltage','MainInterface_BG',0.5,0.5,0.5,0.73,0,255,255,255,255)W('MPIsland_Voltage',h[1],0.457,0.185,0.03,0.09,0,231,99,99,255)W('MPIsland_Voltage',h[2],0.497,0.185,0.03,0.09,0,231,99,99,255)W('MPIsland_Voltage',h[3],0.539,0.185,0.03,0.09,0,231,99,99,255)W('MPIsland_Voltage',f[1],0.29,0.307,0.03,0.09,0,255,255,255,255)W('MPIsland_Voltage',f[2],0.29,0.50,0.03,0.09,0,255,255,255,255)W('MPIsland_Voltage',f[3],0.29,0.694,0.03,0.09,0,255,255,255,255)W('MPIsland_Voltage',s[1],0.699,0.307,0.06,0.08,0,255,255,255,255)W('MPIsland_Voltage',s[2],0.7,0.503,0.05,0.08,0,255,255,255,255)W('MPIsland_Voltage',s[3],0.7,0.698,0.04,0.06,0,255,255,255,255)local ak=0;if i==g then ak=2 else ak=1 end;W('MPIsland_Voltage',tostring(j[1]),0.457,0.815,0.03,0.09,0,p[ak][1],p[ak][2],p[ak][3],q)W('MPIsland_Voltage',tostring(j[2]),0.497,0.815,0.03,0.09,0,p[ak][1],p[ak][2],p[ak][3],q)W('MPIsland_Voltage',tostring(j[3]),0.539,0.815,0.03,0.09,0,p[ak][1],p[ak][2],p[ak][3],q)for z=1,m do W('MPIsland_Voltage','maininterface_progress_highlight',u[z][1],u[z][2],u[z][3],u[z][4],0,88,204,102,255)end;if d==1 then W('MPIsland_Voltage','NUMBER_NODE',0.298,0.307,0.06,0.098,0,250,172,54,255)elseif d==2 then W('MPIsland_Voltage','NUMBER_NODE',0.298,0.5,0.06,0.098,0,247,49,49,255)elseif d==3 then W('MPIsland_Voltage','NUMBER_NODE',0.298,0.693,0.06,0.098,0,58,53,212,255)end;if e==1 then W('MPIsland_Voltage','CIRCLE_NODE',0.691,0.307,0.078,0.13,0,o[d][1],o[d][2],o[d][3],255)elseif e==2 then W('MPIsland_Voltage','CIRCLE_NODE',0.691,0.5,0.078,0.125,0,o[d][1],o[d][2],o[d][3],255)elseif e==3 then W('MPIsland_Voltage','CIRCLE_NODE',0.691,0.694,0.078,0.125,0,o[d][1],o[d][2],o[d][3],255)end;if d~=0 and e~=0 then for z,al in pairs(v[tostring(d)][tostring(e)])do if d and e then N(al[1],al[2],al[3],al[4],o[d][1],o[d][2],o[d][3],r[d])end end end;if B(l)~=0 then for am,an in pairs(l)do for z,al in pairs(v[tostring(an[1])][tostring(an[2])])do if an[1]and an[2]then N(al[1],al[2],al[3],al[4],o[an[1]][1],o[an[1]][2],o[an[1]][3],r[an[1]])end end end end end;print("Ended first Voltlab hacking thread")end)Wait(100)print("Creating second Voltlab hacking thread")CreateThread(function()local ao=0;local ap=0;local aq=setupScaleform("instructional_buttons")while a do Wait(5)DrawScaleformMovieFullscreen(aq,255,255,255,255,0)DisableControlAction(0,172,true)DisableControlAction(0,173,true)DisableControlAction(0,174,true)DisableControlAction(0,175,true)DisableControlAction(0,194,true)DisableControlAction(0,191,true)DisableControlAction(0,24,true)DisableControlAction(0,25,true)if IsDisabledControlJustPressed(0,172)then if d>1 and d<4 then d=d-1;F('Disconnect_Wire','DLC_H4_Voltage_Minigame_Sounds')if e~=0 then ao=ap+f[d]*t[e]J(ao)end end elseif IsDisabledControlJustPressed(0,173)then if d<3 and d>=0 then d=d+1;F('Disconnect_Wire','DLC_H4_Voltage_Minigame_Sounds')if e~=0 then ao=ap+f[d]*t[e]J(ao)end end elseif IsDisabledControlJustPressed(0,174)then if e>1 and e<4 then e=e-1;F('Disconnect_Wire','DLC_H4_Voltage_Minigame_Sounds')ao=ap+f[d]*t[e]J(ao)end elseif IsDisabledControlJustPressed(0,175)then if e<3 and e>=0 then e=e+1;F('Disconnect_Wire','DLC_H4_Voltage_Minigame_Sounds')ao=ap+f[d]*t[e]J(ao)end elseif IsDisabledControlJustPressed(0,194)then n=false;a=false;F('Minigame_Failure','DLC_H4_Voltage_Minigame_Sounds')SendNUIMessage({type='fail'})b=true;c(0,'Hack cancelled')elseif IsDisabledControlJustPressed(0,191)then if e~=0 then if k[tostring(e)]==nil or k[tostring(e)]==false then if l[tostring(d)]==nil or l[tostring(d)]==false then local ar=1;local a6=255;F('OS_Draw','DLC_H4_Voltage_Minigame_Sounds')CreateThread(function()while ar>0 do for z=1,#r do r[z]=a6;if a6<255 then a6=a6+85 else a6=a6-85 end end;Wait(100)end;for z=1,#r do r[z]=255 end end)Wait(1000)ar=0;ap=ap+f[d]*t[e]i=ap;k[tostring(e)]=true;l[tostring(d)]={d,e}if B(l)>=3 then if ap==g then n=true;F('All_Connected_Correct','DLC_H4_Voltage_Minigame_Sounds')local as=1;CreateThread(function()while as>0 do if q<255 then q=q+85 else q=q-85 end;Wait(100)end;q=255 end)Wait(1000)as=0;F('Minigame_Success','DLC_H4_Voltage_Minigame_Sounds')SendNUIMessage({type='success'})a=false;b=true;c(1)else Wait(1000)n=false;a=false;F('Minigame_Failure','DLC_H4_Voltage_Minigame_Sounds')SendNUIMessage({type='fail'})b=true;c(0,'Hack failed')end end end end end end end;print("Ended second Voltlab hacking thread")end)print("Creating third Voltlab hacking thread")CreateThread(function()Wait(5000)local at=timer/6;while timer>0 do Wait(at*1000)timer=timer-at;m=m-1 end;Wait(2000)if n==nil then a=false;F('Minigame_Failure','DLC_H4_Voltage_Minigame_Sounds')SendNUIMessage({type='fail'})if not b then c(2,'Hack timeout out')end end;print("Ended third Voltlab hacking thread")end)end)