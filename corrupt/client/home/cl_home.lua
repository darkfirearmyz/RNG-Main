local a=nil;local b={}local c;local d;local e={}local f=0;local g={}local h={}local i={}local j=module("cfg/homes")RMenu.Add("CORRUPThouses","mainmenu",RageUI.CreateMenu("","",CORRUPT.getRageUIMenuWidth(),CORRUPT.getRageUIMenuHeight(),"CORRUPT_homesui","CORRUPT_homesui"))RMenu:Get("CORRUPThouses","mainmenu"):SetSubtitle("~b~HOME")RMenu.Add('CORRUPThouses','exit',RageUI.CreateMenu("","",CORRUPT.getRageUIMenuWidth(),CORRUPT.getRageUIMenuHeight(),"CORRUPT_homesui","CORRUPT_homesui"))RMenu:Get("CORRUPThouses","exit"):SetSubtitle("~b~HOME")RMenu.Add('CORRUPThouses','rentmanager',RageUI.CreateSubMenu(RMenu:Get('CORRUPThouses','mainmenu'),"","~b~Rent Management Menu",CORRUPT.getRageUIMenuWidth(),CORRUPT.getRageUIMenuHeight()))RMenu.Add('CORRUPThouses','rentedout',RageUI.CreateSubMenu(RMenu:Get('CORRUPThouses','rentmanager'),"","~b~Houses Rented Out",CORRUPT.getRageUIMenuWidth(),CORRUPT.getRageUIMenuHeight()))RMenu.Add('CORRUPThouses','rentedin',RageUI.CreateSubMenu(RMenu:Get('CORRUPThouses','rentmanager'),"","~b~Houses Renting",CORRUPT.getRageUIMenuWidth(),CORRUPT.getRageUIMenuHeight()))RMenu.Add('CORRUPThouses','rentedinfo',RageUI.CreateSubMenu(RMenu:Get('CORRUPThouses','rentmanager'),"","~b~Houses Rent Info",CORRUPT.getRageUIMenuWidth(),CORRUPT.getRageUIMenuHeight()))RageUI.CreateWhile(1.0,RMenu:Get("CORRUPThouses","mainmenu"),nil,function()RageUI.IsVisible(RMenu:Get("CORRUPThouses","mainmenu"),true,false,true,function()if a~=nil and j.homes~=nil then for k,l in pairs(j.homes)do if a==k then RMenu:Get("CORRUPThouses","mainmenu"):SetSubtitle("~b~"..k)RMenu:Get("CORRUPThouses","exit"):SetSubtitle("~b~"..k)if l.ownerString then if l.ownerString=="For sale."then RageUI.ButtonWithStyle("Purchase House","",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then TriggerServerEvent("CORRUPT:buyHome",k)end end)RageUI.ButtonWithStyle("Preview House","",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then TriggerServerEvent("CORRUPT:previewHome",k)end end)end else if clientOwnsHome(k)then RageUI.ButtonWithStyle("Enter House","Enter this home",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o and not CORRUPT.inEvent()then TriggerServerEvent("CORRUPT:enterHome",k)end end)RageUI.ButtonWithStyle("Sell House to Player","",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then TriggerServerEvent("CORRUPT:sellHomeToPlayer",k)end end)RageUI.ButtonWithStyle("Rent House to Player","",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then TriggerServerEvent("CORRUPT:rentHomeToPlayer",k)end end)else RageUI.ButtonWithStyle("Ring Bell","",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then if GetGameTimer()-f>5000 and not CORRUPT.inEvent()then f=GetGameTimer()TriggerServerEvent("CORRUPT:enterHome",k)end end end)if globalOnPoliceDuty then RageUI.ButtonWithStyle("Raid House","~b~MET Police Raid",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then TriggerServerEvent("CORRUPT:raidHome",k)end end)end;if not globalOnPoliceDuty then RageUI.ButtonWithStyle("House Robbery","~r~Break into this house",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o and not CORRUPT.inEvent()then TriggerServerEvent("CORRUPT:houseRobbery",k)end end)end end end;RageUI.ButtonWithStyle("Rent Manager","~y~Manage your rented out & renting houses here.",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then selectedHouse=k end end,RMenu:Get('CORRUPThouses','rentmanager'))end end end end,function()end)RageUI.IsVisible(RMenu:Get("CORRUPThouses","exit"),true,false,true,function()RageUI.ButtonWithStyle("Exit Home","",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then if d then tvRP.teleport(d.x,d.y,d.z)TriggerEvent("CORRUPT:removeFromHome")CORRUPT.leaveActiveHouse()end end end)end,function()end)RageUI.IsVisible(RMenu:Get('CORRUPThouses','rentmanager'),true,true,true,function()RageUI.ButtonWithStyle("Houses Rented Out",selectedHouse,{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then end end,RMenu:Get('CORRUPThouses','rentedout'))RageUI.ButtonWithStyle("Houses Rented In",selectedHouse,{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then end end,RMenu:Get('CORRUPThouses','rentedin'))end,function()end)RageUI.IsVisible(RMenu:Get('CORRUPThouses','rentedout'),true,true,true,function()for p,q in pairs(g)do local k,r,s=q.homeName,q.rentedBy,q.hoursLeft;RageUI.ButtonWithStyle(k,"Rented to "..r.." - "..s.." hours left!",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then i=q;i.type="rentingout"end end,RMenu:Get('CORRUPThouses','rentedinfo'))end end,function()end)RageUI.IsVisible(RMenu:Get('CORRUPThouses','rentedin'),true,true,true,function()for p,q in pairs(h)do local k,r,s=q.homeName,q.rentedBy,q.hoursLeft;RageUI.ButtonWithStyle(k,"Rented from "..r.." - "..s.." hours left!",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then i=q;i.type="rentingin"end end,RMenu:Get('CORRUPThouses','rentedinfo'))end end,function()end)RageUI.IsVisible(RMenu:Get('CORRUPThouses','rentedinfo'),true,true,true,function()local k,r,s=i.homeName,i.rentedBy,i.hoursLeft;RageUI.Separator("~y~Rent Info")RageUI.Separator("---------")RageUI.Separator("House: "..k)RageUI.Separator("Rented from: "..r)RageUI.Separator("Hours Left: "..s)RageUI.ButtonWithStyle("Request Home Rent Cancellation","",{RightLabel="→→→"},true,function(m,n,o)if m then end;if n then end;if o then TriggerServerEvent("CORRUPT:requestHomeRentCancellation",k,i.type)end end)end,function()end)end)local function t(u)a=u;RageUI.CloseAll()RageUI.Visible(RMenu:Get('CORRUPThouses','mainmenu'),true)end;local function v(u)RageUI.CloseAll()RageUI.Visible(RMenu:Get('CORRUPThouses','mainmenu'),false)end;local function w()RageUI.CloseAll()RageUI.Visible(RMenu:Get('CORRUPThouses','exit'),true)end;local function x()RageUI.CloseAll()RageUI.Visible(RMenu:Get('CORRUPThouses','exit'),false)end;Citizen.CreateThread(function()local y=function(z)PlaySound(-1,"Hit","RESPAWN_SOUNDSET",0,0,1)t(z.houseName)end;local A=function(z)PlaySound(-1,"Hit","RESPAWN_SOUNDSET",0,0,1)v(z.houseName)end;local B=function(z)end;for k,l in pairs(j.homes)do l.position=vector3(l.entry_point[1],l.entry_point[2],l.entry_point[3])CORRUPT.createArea("house_"..k,l.position,1.5,6,y,A,B,{houseName=k})tvRP.addMarker(l.position.x,l.position.y,l.position.z-1,0.7,0.7,0.5,0,255,125,125,50,20,false,false,true)end end)RegisterNetEvent("CORRUPT:houseBought",function(k)if e["home_"..k]then tvRP.removeBlip(e["home_"..k])e["home_"..k]=nil end;j.homes[k].ownerString=nil end)RegisterNetEvent("CORRUPT:updateHomeData",function(C,D)j.homes[C]=D end)RegisterNetEvent("CORRUPT:sendOwnedHomes",function(E)b=E end)RegisterNetEvent("CORRUPT:addHome",function(F)b[F]=true;j.homes[F].ownerString=nil end)RegisterNetEvent("CORRUPT:removeHome",function(k)b[k]=nil;if e["home_"..k]then tvRP.removeBlip(e["home_"..k])e["home_"..k]=nil end end)function clientOwnsHome(C)if b[C]then return true else return false end end;RegisterNetEvent("CORRUPT:createHouseExit",function(G,H)c=G;d=H end)RegisterNetEvent("CORRUPT:forceBoltCutting",function()TaskStartScenarioInPlace(CORRUPT.getPlayerPed(),"WORLD_HUMAN_WELDING",0,true)local I=true;SetTimeout(300000,function()I=false end)local J=GetGameTimer()tvRP.notify("~g~House Robbery in progress, you can cancel by pressing [E].")while I and GetEntityHealth(CORRUPT.getPlayerPed())>102 do if not IsPedUsingScenario(CORRUPT.getPlayerPed(),"WORLD_HUMAN_WELDING")then TaskStartScenarioInPlace(CORRUPT.getPlayerPed(),"WORLD_HUMAN_WELDING",0,true)end;local K=math.floor((GetGameTimer()-J)/300000*100)drawNativeText("~b~House Robbery - "..K.."%")if IsControlJustPressed(0,38)then tvRP.notify("~b~House Robbery cancelled.")I=false;ClearPedTasks(CORRUPT.getPlayerPed())end;Wait(0)end end)Citizen.CreateThread(function()local L=false;while true do if c then local M=CORRUPT.getPlayerPed()local N=GetEntityCoords(CORRUPT.getPlayerPed())if#(N-c)<1.5 then w()L=false elseif not L then L=true;x()end end;Wait(250)end end)RegisterNetEvent("CORRUPT:initRentingHouses",function(O)g=O end)RegisterNetEvent("CORRUPT:initRentedHouses",function(P)h=P end)RegisterNetEvent("CORRUPT:insertRentedHouse",function(Q)table.insert(h,Q)end)RegisterNetEvent("CORRUPT:insertRentingHouse",function(R)table.insert(g,R)end)RegisterNetEvent("CORRUPT:decreaseHourRentedHouses",function(C)for S,T in pairs(h)do if string.lower(T.homeName)==string.lower(C)then if h[S].hoursLeft>1 then h[S].hoursLeft=h[S].hoursLeft-1 else h[S]=nil end end end end)RegisterNetEvent("CORRUPT:decreaseHourRentingHouses",function(C)for S,T in pairs(g)do if string.lower(T.homeName)==string.lower(C)then if g[S].hoursLeft>1 then g[S].hoursLeft=g[S].hoursLeft-1 else g[S]=nil end end end end)RegisterNetEvent("CORRUPT:endRentedHouse",function(C)for S,T in pairs(h)do if string.lower(T.homeName)==string.lower(C)then h[S]=nil end end end)RegisterNetEvent("CORRUPT:endRentingHouse",function(C)for S,T in pairs(g)do if string.lower(T.homeName)==string.lower(C)then g[S]=nil end end end)RegisterNetEvent("CORRUPT:someoneAtTheDoor",function()local U=GetSoundId()PlaySoundFrontend(U,"DOOR_Intercom_MASTER",0,false)ReleaseSoundId(U)end)RegisterNetEvent("CORRUPT:setupHomesForSale",function(V)for F,p in pairs(V)do j.homes[F].ownerString="For sale."end;for k,l in pairs(j.homes)do if l.ownerString=="For sale."then e["home_"..k]=tvRP.addBlip(l.entry_point[1],l.entry_point[2],l.entry_point[3],l.blipId,l.blipColour,k)end end end)RegisterNetEvent("CORRUPT:sendHomeBlips",function(W)for p,T in pairs(W)do local C=T[1]local X=T[2]tvRP.addBlip(X.x,X.y,X.z,374,1,C)end end)RegisterNetEvent("CORRUPT:houseGettingRobbed",function(k,Y)local U=GetSoundId()PlaySoundFrontend(U,"End_Zone_Flash","DLC_BTL_RB_Remix_Sounds",true)ReleaseSoundId(U)if Y then CORRUPT.announceMpBigMsg("~b~WARNING","~b~Your house "..k.." is being RAIDED by the MET Police!",5000)else CORRUPT.announceMpBigMsg("~r~WARNING","Your house "..k.." is being BROKEN INTO!",5000)end end)function CORRUPT.leaveActiveHouse()if a then c=nil;d=nil;TriggerServerEvent("CORRUPT:exitHome",a)a=nil end end